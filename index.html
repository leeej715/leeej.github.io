<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Five Elements Finder</title>

  <meta name="theme-color" content="#0b0c10" />
  <meta name="apple-mobile-web-app-capable" content="yes" />

  <style>
    :root{
      --bg:#0b0c10;
      --card:#121420;
      --line:#262b44;
      --text:#eaf0ff;
      --muted:#b8c4ff;
      --muted2:#94a3d6;
      --btn:#1b2140;
      --btn2:#10142a;
      --focus:#7aa2ff;
      --radius:18px;
    }
    *{ box-sizing:border-box; }
    html,body{ height:100%; }
    body{
      margin:0;
      background: radial-gradient(1200px 600px at 10% 0%, #121a3a 0%, transparent 55%),
                  radial-gradient(1000px 500px at 90% 10%, #1b1340 0%, transparent 60%),
                  var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial, "Noto Sans", "Apple SD Gothic Neo", "Noto Sans KR", sans-serif;
      -webkit-font-smoothing: antialiased;
      text-rendering: optimizeLegibility;
    }
    .wrap{
      max-width: 860px;
      margin: 0 auto;
      padding: 18px 16px 28px;
    }

    .header{ display:flex; flex-direction: column; gap: 6px; margin: 10px 0 14px; }
    .title{
      font-size: clamp(20px, 4.8vw, 28px);
      font-weight: 820;
      letter-spacing: .2px;
      line-height: 1.15;
      margin:0;
    }
    .subtitle{
      margin:0;
      color: var(--muted);
      line-height: 1.4;
      font-size: 14px;
    }

    .card{
      background: color-mix(in oklab, var(--card), #000 10%);
      border: 1px solid color-mix(in oklab, var(--line), #000 15%);
      border-radius: var(--radius);
      padding: 16px;
      box-shadow: 0 18px 45px rgba(0,0,0,.32);
      backdrop-filter: blur(6px);
    }

    .grid{
      display:grid;
      grid-template-columns: 1fr;
      gap: 12px;
    }

    /* 3-field date layout */
    .grid.three{
      grid-template-columns: 1.2fr 1fr 1fr;
    }

    label{ display:block; font-size: 13px; color: var(--muted); margin: 2px 0 8px; }

    input[type="text"]{
      width:100%;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid color-mix(in oklab, var(--line), #000 20%);
      background: var(--btn2);
      color: var(--text);
      font-size: 16px; /* prevent iOS zoom */
      outline: none;
    }
    input[type="text"]:focus{
      border-color: color-mix(in oklab, var(--focus), #fff 5%);
      box-shadow: 0 0 0 3px rgba(122,162,255,.20);
    }

    .actions{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
      margin-top: 12px;
    }
    button{
      width:100%;
      padding: 14px 14px;
      border-radius: 14px;
      border: 1px solid color-mix(in oklab, var(--line), #000 20%);
      background: var(--btn);
      color: var(--text);
      font-size: 16px;
      font-weight: 800;
      cursor:pointer;
      touch-action: manipulation;
    }
    button.secondary{
      background: rgba(16,20,42,.55);
      font-weight: 750;
      color: var(--muted);
    }
    button:hover{ filter: brightness(1.08); }
    button:active{ transform: translateY(1px); }

    .result{
      margin-top: 14px;
      padding: 16px;
      border-radius: var(--radius);
      border: 1px dashed color-mix(in oklab, var(--line), #000 10%);
      background: rgba(16,20,42,.55);
      display:none;
    }
    .bigline{
      display:flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: flex-start;
      justify-content: space-between;
    }
    .big{
      font-size: clamp(22px, 6vw, 34px);
      font-weight: 900;
      letter-spacing: .2px;
      margin:0;
      line-height: 1.05;
    }
    .subbig{
      margin: 8px 0 0;
      font-size: 15px;
      color: var(--muted);
      font-weight: 750;
      line-height: 1.25;
    }
    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 7px 11px;
      border-radius: 999px;
      border: 1px solid color-mix(in oklab, var(--line), #000 20%);
      background: rgba(0,0,0,.18);
      color: var(--muted);
      font-size: 13px;
      font-weight: 750;
      white-space: nowrap;
    }

    details{
      margin-top: 12px;
      border-top: 1px solid rgba(38,43,68,.7);
      padding-top: 10px;
    }
    summary{
      cursor:pointer;
      color: var(--muted);
      font-weight: 800;
      font-size: 14px;
      list-style: none;
      outline:none;
    }
    summary::-webkit-details-marker{ display:none; }
    .detail-grid{
      margin-top: 10px;
      display:grid;
      gap: 8px;
      font-size: 14px;
      color: var(--muted);
    }
    .mono{ font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace; color: var(--text); }

    .note{
      margin-top: 12px;
      font-size: 12px;
      color: var(--muted2);
      line-height: 1.35;
    }

    /* Make it stack on very small screens */
    @media (max-width: 420px){
      .grid.three{ grid-template-columns: 1fr; }
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <h1 class="title">Five Elements Finder</h1>

      <p class="subtitle">
        Enter your birth date. You can know your element.<br>
        Tree(Wood) / Fire / Earth(Soil) / Metal(Gold) / Water.
      </p>
    </div>

    <div class="card">
      <div class="grid three">
        <div>
          <label for="birthYear">Year</label>
          <input id="birthYear" type="text" inputmode="numeric" autocomplete="bday-year" placeholder="YYYY" />
        </div>
        <div>
          <label for="birthMonth">Month</label>
          <input id="birthMonth" type="text" inputmode="numeric" autocomplete="bday-month" placeholder="MM" />
        </div>
        <div>
          <label for="birthDay">Day</label>
          <input id="birthDay" type="text" inputmode="numeric" autocomplete="bday-day" placeholder="DD" />
        </div>
      </div>

      <div class="actions">
        <button id="calcBtn">Calculate</button>
        <button id="resetBtn" class="secondary" type="button">Reset</button>
      </div>

      <div id="out" class="result"></div>

      <div class="note">
        Quick, presentation-friendly checker (date only).
      </div>
    </div>
  </div>

<script>
  const STEMS = ["Áî≤","‰πô","‰∏ô","‰∏Å","Êàä","Â∑±","Â∫ö","Ëæõ","Â£¨","Áô∏"];
  const BRANCHES = ["Â≠ê","‰∏ë","ÂØÖ","ÂçØ","Ëæ∞","Â∑≥","Âçà","Êú™","Áî≥","ÈÖâ","Êàå","‰∫•"];

  function mod(n, m){ return ((n % m) + m) % m; }

  // Gregorian date -> Julian Day Number at noon (integer)
  function jdnNoon(y, m, d){
    const a = Math.floor((14 - m) / 12);
    const y2 = y + 4800 - a;
    const m2 = m + 12 * a - 3;
    return d
      + Math.floor((153 * m2 + 2) / 5)
      + 365 * y2
      + Math.floor(y2 / 4)
      - Math.floor(y2 / 100)
      + Math.floor(y2 / 400)
      - 32045;
  }

  // Sexagenary day stem/branch from JD_noon:
  // T = 1 + mod(JD_noon - 1, 10)
  // B = 1 + mod(JD_noon + 1, 12)
  function dayPillarFromDate(y, m, d){
    const jd = jdnNoon(y, m, d);
    const T = 1 + mod(jd - 1, 10);
    const B = 1 + mod(jd + 1, 12);
    return { jd, stemIndex: T, branchIndex: B, pillar: STEMS[T-1] + BRANCHES[B-1] };
  }

  // UI labels: Tree/Fire/Soil/Metal/Water (presentation-friendly)
  // Day Master: Big/Small + Chinese + Korean reading
  function dayMasterInfo(T){
    switch (T){
      case 1: return { element:"Tree",  emoji:"üå≥", label:"Wood(Tree)",   roman:"Jia",  han:"Áî≤Êú®", ko:"Í∞ëÎ™©" };
      case 2: return { element:"Tree",  emoji:"üåø", label:"Wood(Grass)", roman:"Yi",   han:"‰πôÊú®", ko:"ÏùÑÎ™©" };
      case 3: return { element:"Fire",  emoji:"üî•", label:"Fire(Sun)",   roman:"Bing", han:"‰∏ôÁÅ´", ko:"Î≥ëÌôî" };
      case 4: return { element:"Fire",  emoji:"üïØÔ∏è", label:"Fire(Candle)", roman:"Ding", han:"‰∏ÅÁÅ´", ko:"Ï†ïÌôî" };
      case 5: return { element:"Soil",  emoji:"üåé", label:"Earth",  roman:"Wu",   han:"ÊàäÂúü", ko:"Î¨¥ÌÜ†" };
      case 6: return { element:"Soil",  emoji:"ü™®", label:"Earth(Farmland)",roman:"Ji",   han:"Â∑±Âúü", ko:"Í∏∞ÌÜ†" };
      case 7: return { element:"Metal", emoji:"ü™ô", label:"Metal(steel)",  roman:"Geng", han:"Â∫öÈáë", ko:"Í≤ΩÍ∏à" };
      case 8: return { element:"Metal", emoji:"üíé", label:"Metal(jewel)",roman:"Xin",  han:"ËæõÈáë", ko:"Ïã†Í∏à" };
      case 9: return { element:"Water", emoji:"üåä", label:"Water(Ocean)",  roman:"Ren",  han:"Â£¨Ê∞¥", ko:"ÏûÑÏàò" };
      case 10:return { element:"Water", emoji:"üíß", label:"Water(River)",roman:"Gui",  han:"Áô∏Ê∞¥", ko:"Í≥ÑÏàò" };
      default:return { element:"", emoji:"", label:"", roman:"", han:"", ko:"" };
    }
  }

  function pad2(n){ return String(n).padStart(2, "0"); }

  function toInt(v){ return Number(String(v).trim()); }

  function isValidDate(y, m, d){
    if (!Number.isInteger(y) || !Number.isInteger(m) || !Number.isInteger(d)) return false;
    if (y < 1800 || y > 2200) return false;
    if (m < 1 || m > 12) return false;
    if (d < 1 || d > 31) return false;

    const dt = new Date(Date.UTC(y, m - 1, d));
    return dt.getUTCFullYear() === y && (dt.getUTCMonth() + 1) === m && dt.getUTCDate() === d;
  }

  const birthYear = document.getElementById("birthYear");
  const birthMonth = document.getElementById("birthMonth");
  const birthDay = document.getElementById("birthDay");

  const out = document.getElementById("out");
  const calcBtn = document.getElementById("calcBtn");
  const resetBtn = document.getElementById("resetBtn");

  function renderError(msg){
    out.style.display = "block";
    out.innerHTML = `<div style="color:#ffd6d6;font-weight:800;">${msg}</div>`;
  }

  function calculate(){
    out.style.display = "none";
    out.innerHTML = "";

    const y = toInt(birthYear.value);
    const m = toInt(birthMonth.value);
    const d = toInt(birthDay.value);

    if (!birthYear.value || !birthMonth.value || !birthDay.value){
      renderError("Please enter Year, Month, and Day.");
      return;
    }

    if (!isValidDate(y, m, d)){
      renderError("Invalid date. Please check Year / Month / Day.");
      return;
    }

    const day = dayPillarFromDate(y, m, d);
    const info = dayMasterInfo(day.stemIndex);
    const dayStem = STEMS[day.stemIndex - 1];

    out.innerHTML = `
      <div class="bigline">
        <div>
          <p class="big">${info.emoji} ${info.element}</p>
          <div class="subbig">
            Day Master: <span class="mono">${info.label}</span>
            (${info.roman} ¬∑ <span class="mono">${info.han}</span> ¬∑ ${info.ko})
          </div>
        </div>
        <span class="pill">Day Stem: <span class="mono">${dayStem}</span></span>
      </div>

      <details>
        <summary>Show details</summary>
        <div class="detail-grid">
          <div>Day Pillar (Stem+Branch): <span class="mono">${day.pillar}</span></div>
          <div style="color:var(--muted2);font-size:12px;">Date used: ${y}-${pad2(m)}-${pad2(d)}</div>
        </div>
      </details>
    `;
    out.style.display = "block";
  }

  function resetAll(){
    birthYear.value = "";
    birthMonth.value = "";
    birthDay.value = "";
    out.style.display = "none";
    out.innerHTML = "";
  }

  function digitsOnly(el, maxLen){
    el.addEventListener("input", () => {
      el.value = el.value.replace(/\D/g, "").slice(0, maxLen);
    });
  }
